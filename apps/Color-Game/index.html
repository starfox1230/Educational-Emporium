<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Color Learning Game</title>
  <style>
    /* Add text selection prevention */
    body, h1, .color-box {
      -webkit-user-select: none; /* Safari */
      -ms-user-select: none; /* IE 10+ */
      user-select: none;
      -webkit-touch-callout: none; /* iOS Safari */
    }

    body { 
      font-family: 'Arial', sans-serif; 
      text-align: center; 
      margin: 0; 
      padding: 0;
      display: flex; 
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #333;
      transition: background-color 0.5s ease;
    }

    h1 {
      font-size: 3em;
      margin-bottom: 20px;
      color: white;
      opacity: 1;
      transition: opacity 0.5s ease;
    }

    #color-grid { 
      display: flex; 
      justify-content: center; 
      width: 90%; 
      margin: auto;
      touch-action: manipulation; /* Improve touch responsiveness */
    }

    .color-box { 
      flex: 1; 
      margin: 10px; 
      height: 150px; 
      border-radius: 10px; 
      transition: transform 0.5s ease, box-shadow 0.5s ease, background-color 0.5s ease;
      opacity: 1;
      cursor: pointer;
      touch-action: manipulation; /* Prevent browser touch behaviors */
    }

    /* Keep all previous animations and styles below */
    .highlight { 
      box-shadow: 0 0 20px 10px rgba(255, 255, 255, 0.8);
      transform: scale(1.1);
    }

    .correct { 
      transform: scale(1.3); 
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.8); 
      transition: transform 0.7s ease, box-shadow 0.7s ease;
    }

    .wrong {
      animation: shake 0.5s ease;
      border: 5px solid red;
      transform: scale(1.1);
    }

    .red { background-color: red; }
    .orange { background-color: orange; }
    .yellow { background-color: yellow; }
    .green { background-color: green; }
    .blue { background-color: blue; }
    .purple { background-color: purple; }

    @media screen and (min-width: 768px) {
      h1 {
        font-size: 4em;
      }
      .color-box {
        height: 200px;
      }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-10px); }
      40%, 80% { transform: translateX(10px); }
    }

    .fade-out {
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .fade-in {
      opacity: 1;
      transition: opacity 0.5s ease;
    }

    .disabled {
      pointer-events: none;
    }
  </style>
</head>
<body>

<h1 id="question">Which color is?</h1>
<div id="color-grid">
  <div class="color-box red" id="red"></div>
  <div class="color-box orange" id="orange"></div>
  <div class="color-box yellow" id="yellow"></div>
  <div class="color-box green" id="green"></div>
  <div class="color-box blue" id="blue"></div>
  <div class="color-box purple" id="purple"></div>
</div>

<audio id="question-sound" src=""></audio>
<audio id="response-sound" src=""></audio>

<script>
  // Keep all JavaScript the same as before
  let selectedIndex = 0;
  const colorBoxes = document.querySelectorAll('.color-box');
  const questionAudio = document.getElementById('question-sound');
  const responseAudio = document.getElementById('response-sound');
  const questionElement = document.getElementById('question');
  const gridElement = document.getElementById('color-grid');

  const questions = [
    { question: "Which color is red?", answer: "red", questionAudio: "question_red.mp3", correctAudio: "correct_red.mp3", incorrectAudio: "wrong_red.mp3" },
    { question: "Which color is orange?", answer: "orange", questionAudio: "question_orange.mp3", correctAudio: "correct_orange.mp3", incorrectAudio: "wrong_orange.mp3" },
    { question: "Which color is yellow?", answer: "yellow", questionAudio: "question_yellow.mp3", correctAudio: "correct_yellow.mp3", incorrectAudio: "wrong_yellow.mp3" },
    { question: "Which color is green?", answer: "green", questionAudio: "question_green.mp3", correctAudio: "correct_green.mp3", incorrectAudio: "wrong_green.mp3" },
    { question: "Which color is blue?", answer: "blue", questionAudio: "question_blue.mp3", correctAudio: "correct_blue.mp3", incorrectAudio: "wrong_blue.mp3" },
    { question: "Which color is purple?", answer: "purple", questionAudio: "question_purple.mp3", correctAudio: "correct_purple.mp3", incorrectAudio: "wrong_purple.mp3" }
  ];

  let currentQuestion = 0;
  let gameActive = true;

  function shuffleQuestions() {
    for (let i = questions.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [questions[i], questions[j]] = [questions[j], questions[i]];
    }
  }

  function updateSelection() {
    colorBoxes.forEach(box => box.classList.remove('highlight'));
    colorBoxes[selectedIndex].classList.add('highlight');
  }

  function playAudio(audioElement, src) {
    audioElement.src = src;
    audioElement.play();
  }

  function handleSelection(selectedColor) {
    if (!gameActive) return;
    const correctColor = questions[currentQuestion].answer;

    if (selectedColor === correctColor) {
      playAudio(responseAudio, questions[currentQuestion].correctAudio);
      showCorrectAnswerTransition();
    } else {
      playAudio(responseAudio, questions[currentQuestion].incorrectAudio);
      responseAudio.src = `No, that's ${correctColor}.`;
      showWrongAnswerTransition();
    }
  }

  function showWrongAnswerTransition() {
    gameActive = false;
    const selectedBox = colorBoxes[selectedIndex];
    selectedBox.classList.add('wrong');

    setTimeout(() => {
      selectedBox.classList.remove('wrong');
      gameActive = true;
    }, 500);
  }

  function showCorrectAnswerTransition() {
    gameActive = false;
    colorBoxes[selectedIndex].classList.add('correct');
    questionElement.classList.add('fade-out');
    
    setTimeout(() => {
      colorBoxes[selectedIndex].classList.remove('correct');
      questionElement.classList.remove('fade-out');
      nextQuestion();
    }, 1500);
  }

  function nextQuestion() {
    currentQuestion = (currentQuestion + 1) % questions.length;
    questionElement.textContent = questions[currentQuestion].question;
    playAudio(questionAudio, questions[currentQuestion].questionAudio);
    questionElement.classList.add('fade-in');
    
    setTimeout(() => {
      questionElement.classList.remove('fade-in');
      gameActive = true;
    }, 500);
  }

  colorBoxes.forEach((box, index) => {
    box.addEventListener('click', function() {
      selectedIndex = index;
      updateSelection();
      handleSelection(box.id);
    });
  });

  document.addEventListener('keydown', function(event) {
    if (!gameActive) return;

    switch(event.code) {
      case 'F8':
        selectedIndex = (selectedIndex === 0) ? colorBoxes.length - 1 : selectedIndex - 1;
        updateSelection();
        break;
      case 'F11':
        selectedIndex = (selectedIndex === colorBoxes.length - 1) ? 0 : selectedIndex + 1;
        updateSelection();
        break;
      case 'F1':
        handleSelection(colorBoxes[selectedIndex].id);
        break;
      case 'ArrowRight':
        replayQuestionAudio();
        break;
    }
  });

  shuffleQuestions();
  questionElement.textContent = questions[currentQuestion].question;
  playAudio(questionAudio, questions[currentQuestion].questionAudio);
  updateSelection();

</script>

</body>
</html>