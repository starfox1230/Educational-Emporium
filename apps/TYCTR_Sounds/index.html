<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Phonics Randomizer</title>
  <!-- Prevent zooming and highlighting on mobile -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    /* Basic reset and mobile-friendly styling */
    html, body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      /* Prevent text selection, double-tap zoom, etc. */
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-touch-callout: none;
      touch-action: manipulation;
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      background: #f5f5f5;
    }

    /* Container for the selection screen */
    #selectionScreen {
      width: 90%;
      max-width: 600px;
      margin: 10px auto;
    }

    #selectionOptions {
      margin-bottom: 10px;
      padding: 10px;
      background: #ddd;
      border-radius: 5px;
    }

    #selectionOptions label {
      cursor: pointer;
      font-weight: bold;
    }

    .imageCheckbox {
      display: flex;
      align-items: center;
      margin: 5px 0;
    }

    .imageCheckbox img {
      width: 48px;
      height: auto;
      margin-right: 8px;
      vertical-align: middle;
    }

    .imageCheckbox input[type="checkbox"] {
      transform: scale(1.3);
      margin-right: 8px;
      cursor: pointer;
    }

    #startButton {
      display: inline-block;
      margin: 10px 0;
      padding: 10px 20px;
      background: #007bff;
      color: #fff;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      cursor: pointer;
    }

    #startButton:hover {
      background: #0056b3;
    }

    /* Game screen styling */
    #gameScreen {
      display: none;
      width: 100%;
      height: 100vh; /* Fill screen for easy tapping */
      background: #f5f5f5;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    #randomImage {
      max-width: 60%;
      height: auto;
      margin: 0 auto;
    }

    /* Prevent highlight on tap in some browsers */
    body, button, input, label, select, textarea {
      -webkit-tap-highlight-color: transparent;
    }
  </style>
</head>
<body>

<div id="selectionScreen">
  <div id="selectionOptions">
    <label>
      <input type="checkbox" id="rangeModeCheckbox">
      Range Mode (check two or more to create a continuous range)
    </label>
  </div>

  <!-- The list of images with checkboxes -->
  <script>
    // The ordered list of filenames (adjust to match your actual files):
    var imageFilenames = [
      "m.png",
      "short_a.png",
      "s.png",
      "long_e.png",
      "t.png",
      "r.png",
      "d.png",
      "short_i.png",
      "th.png",
      "c.png",
      "short_o.png",
      "n.png",
      "f.png",
      "short_u.png",
      "l.png",
      "w.png",
      "g.png",
      "word_i.png",
      "sh.png",
      "long_a.png",
      "h.png",
      "k.png",
      "long_o.png",
      "v.png",
      "p.png",
      "ar.png",
      "ch.png",
      "short_e.png",
      "b.png",
      "ing.png",
      "long_i.png",
      "y.png",
      "er.png",
      "long_oo.png",
      "j.png",
      "wh.png",
      "long_y.png",
      "long_u.png",
      "qu.png",
      "x.png",
      "z.png",
      "ea.png",
      "ai.png",
      "ou.png"
    ];
  </script>

  <div id="imagesList"></div>

  <button id="startButton">Start Game</button>
</div>

<div id="gameScreen">
  <img id="randomImage" src="" alt="Random Image">
</div>

<script>
  const selectionScreen = document.getElementById('selectionScreen');
  const gameScreen = document.getElementById('gameScreen');
  const imagesList = document.getElementById('imagesList');
  const startButton = document.getElementById('startButton');
  const randomImage = document.getElementById('randomImage');
  const rangeModeCheckbox = document.getElementById('rangeModeCheckbox');

  // Build the list of checkboxes
  const checkboxes = [];
  imageFilenames.forEach(function(filename, index) {
    const div = document.createElement('div');
    div.className = 'imageCheckbox';

    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.value = filename;
    checkbox.dataset.index = index; // store the index in the dataset for easy reference

    // Create an <img> preview
    const img = document.createElement('img');
    img.src = 'images/' + filename;

    const label = document.createElement('label');
    label.textContent = filename;

    // Add "change" event to handle range logic
    checkbox.addEventListener('change', function() {
      if (rangeModeCheckbox.checked) {
        applyRangeSelection();
      }
    });

    div.appendChild(checkbox);
    div.appendChild(img);
    div.appendChild(label);

    imagesList.appendChild(div);
    checkboxes.push(checkbox);
  });

  // If "range mode" is on, automatically select a continuous range from the
  // earliest checked index to the latest checked index.
  function applyRangeSelection() {
    // Gather all checked indices
    let checkedIndices = [];
    checkboxes.forEach(cb => {
      if (cb.checked) {
        checkedIndices.push(parseInt(cb.dataset.index, 10));
      }
    });

    if (checkedIndices.length < 2) {
      // If there's only one or zero checked boxes, do nothing special
      return;
    }

    // Find min and max index
    let minIndex = Math.min(...checkedIndices);
    let maxIndex = Math.max(...checkedIndices);

    // Uncheck everything first
    checkboxes.forEach(cb => {
      cb.checked = false;
    });

    // Check everything in [minIndex, maxIndex]
    for (let i = minIndex; i <= maxIndex; i++) {
      checkboxes[i].checked = true;
    }
  }

  // Handle the "Start Game" button
  startButton.addEventListener('click', function() {
    // Gather selected images (i.e., checkboxes that are checked)
    let selectedFilenames = [];
    checkboxes.forEach((cb) => {
      if (cb.checked) {
        selectedFilenames.push(cb.value);
      }
    });

    if (selectedFilenames.length === 0) {
      alert("No images selected. Please select at least one.");
      return;
    }

    // Hide the selection screen, show the game screen
    selectionScreen.style.display = 'none';
    gameScreen.style.display = 'flex';

    // We'll store the selected images in a global array
    window.selectedImages = selectedFilenames;

    // Show an initial random image
    showRandomImage();
  });

  // Function to show a random image
  function showRandomImage() {
    if (!window.selectedImages || window.selectedImages.length === 0) return;
    const randomIndex = Math.floor(Math.random() * window.selectedImages.length);
    randomImage.src = 'images/' + window.selectedImages[randomIndex];
  }

  // When user taps/clicks anywhere in the #gameScreen, show a new random image
  gameScreen.addEventListener('click', showRandomImage);

  // Also handle touchstart